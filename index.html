<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sidhu Assistant ‚Äî Chat</title>
  <style>
    :root{--accent:#0b76ef;--bg:#f6f9ff;--card:#ffffff;--muted:#666;}
    body{font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:var(--bg); margin:0; padding:24px; color:#111;}
    .container{max-width:900px;margin:0 auto;}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px;}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#7cc8ff);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:20px;}
    h1{margin:0;font-size:20px;}
    p.lead{color:var(--muted);margin:6px 0 18px;}
    .card{background:var(--card);border-radius:12px;padding:16px;box-shadow:0 6px 18px rgba(11,118,239,0.06);}
    .quick-actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;}
    .btn{background:transparent;border:1px solid #e6f0ff;padding:8px 12px;border-radius:8px;cursor:pointer;display:inline-flex;gap:8px;align-items:center;}
    .btn.primary{background:var(--accent);color:#fff;border-color:var(--accent);}
    .note{font-size:13px;color:var(--muted);margin-top:12px}
    .samples{margin-top:14px;}
    pre{background:#f3f6fb;padding:12px;border-radius:8px;overflow:auto;}
    footer{margin-top:18px;color:var(--muted);font-size:13px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">SA</div>
      <div>
        <h1>Sidhu Assistant</h1>
        <p class="lead">Chatbot ‚Äî quick fitness intents & Watson Assistant embed</p>
      </div>
    </header>

    <div class="card">
      <strong>Quick actions</strong>
      <div class="quick-actions" role="group" aria-label="Quick replies">
        <button class="btn primary" onclick="sendQuick('workout_plan')">üèãÔ∏è Plan workout</button>
        <button class="btn" onclick="sendQuick('exercises')">üìù Show exercises</button>
        <button class="btn" onclick="sendQuick('track_progress')">üìà Track progress</button>
      </div>

      <div class="note">
        Tip: Click a quick action to open the chat and send a ready-made message. If automatic sending is not supported by your Watson chat version, the message will be copied to clipboard so you can paste it.
      </div>

      <div class="samples">
        <strong>Example messages sent by each quick action</strong>
        <pre id="examples">
workout_plan  ‚Üí "Create a 4-week workout plan for intermediate gym-goer focusing on muscle gain."
exercises     ‚Üí "List 10 chest exercises with short instructions for each."
track_progress‚Üí "Log workout: Chest & Triceps ‚Äî Bench press 4x8 @70kg, Push-ups 3x15. Track progress."
        </pre>
      </div>
    </div>

    <div class="card" style="margin-top:12px">
      <strong>Embedded Watson Chat</strong>
      <p class="note">The chat widget will appear as a floating assistant (provided by IBM Watson). If it doesn't load, check your integration IDs in the script below.</p>

      <!-- Optional inline fallback chat area (not functional, just instruction) -->
      <div style="margin-top:8px">
        <small style="color:var(--muted)">If you want the chat widget to open automatically, use the "Open chat" button below after the widget loads.</small>
        <div style="margin-top:8px">
          <button class="btn" onclick="openChat()">Open chat</button>
          <button class="btn" onclick="focusChat()">Focus (try programmatic send)</button>
        </div>
      </div>
    </div>

    <footer>Made for Sidhu Assistant ‚Ä¢ Edit quick messages in the script below</footer>
  </div>

  <!-- Paste your Watson Assistant web chat snippet (keeps your original IDs) -->
  <script>
    window.watsonAssistantChatOptions = {
      integrationID: "4540c71e-03bc-4f61-8116-16ae72c106c3", // The ID of this integration.
      region: "au-syd", // The region your integration is hosted in.
      serviceInstanceID: "e92be863-48f5-4885-b876-59a063265841", // The ID of your service instance.
      onLoad: async (instance) => {
        // store instance globally for button handlers
        window.watsonChatInstance = instance;
        try {
          await instance.render(); // render the web chat UI
          console.log("Watson Assistant chat rendered");
        } catch (err) {
          console.error("Error rendering Watson chat:", err);
        }
      }
    };
    setTimeout(function(){
      const t=document.createElement('script');
      t.src="https://web-chat.global.assistant.watson.appdomain.cloud/versions/" + (window.watsonAssistantChatOptions.clientVersion || 'latest') + "/WatsonAssistantChatEntry.js";
      document.head.appendChild(t);
    });
  </script>

  <script>
    // Mapping of quick intents to natural language prompts (customize these)
    const QUICK_MESSAGES = {
      "workout_plan": "Create a 4-week workout plan for intermediate gym-goer focusing on muscle gain.",
      "exercises": "List 10 chest exercises with short instructions for each.",
      "track_progress": "Log workout: Chest & Triceps ‚Äî Bench press 4x8 @70kg, Push-ups 3x15. Track progress."
    };

    // Attempt to open the chat window (API may vary by Watson version)
    function openChat(){
      const inst = window.watsonChatInstance;
      if(inst && typeof inst.open === 'function'){
        inst.open();
      } else if(inst && typeof inst.render === 'function'){
        inst.render();
      } else {
        alert('Chat widget not ready yet. Wait a moment and try again.');
      }
    }

    function focusChat(){
      // best-effort focus + warm check
      if(window.watsonChatInstance){
        try{
          // some SDK versions expose open/close/send methods
          if(typeof window.watsonChatInstance.open === 'function') window.watsonChatInstance.open();
          else if(typeof window.watsonChatInstance.render === 'function') window.watsonChatInstance.render();
        } catch(e){
          console.log("Could not programmatically open chat:", e);
        }
        alert("Chat instance available ‚Äî try quick replies or paste a message into the chat input.");
      } else {
        alert("Chat instance not available yet. Wait a few seconds and try again.");
      }
    }

    // Primary quick-reply sender. Tries programmatic send, else falls back to copy-to-clipboard.
    async function sendQuick(key){
      const text = QUICK_MESSAGES[key] || key;
      const inst = window.watsonChatInstance;

      // 1) Try known programmatic send signatures (best-effort)
      try {
        if(inst){
          // Attempt 1: instance.send (some versions)
          if(typeof inst.send === 'function'){
            inst.send(text);
            return;
          }
          // Attempt 2: instance.sendMessage or instance.sendInputEvent
          if(typeof inst.sendMessage === 'function'){
            inst.sendMessage(text);
            return;
          }
          // Attempt 3: newer versions accept an event-like object
          if(typeof inst.sendEvent === 'function'){
            inst.sendEvent({type:'input', text});
            return;
          }
          // Attempt 4: postMessage to iframe (rare)
          if(inst._iframe && inst._iframe.contentWindow){
            inst._iframe.contentWindow.postMessage({type:'user-input', text}, '*');
            return;
          }
        }
      } catch(err){
        console.warn("Programmatic send failed:", err);
      }

      // 2) Fallback: copy to clipboard and prompt user to paste
      try {
        await navigator.clipboard.writeText(text);
        alert("Message copied to clipboard. Open the chat and paste (Ctrl+V) to send:\n\n" + text);
        // try to open the widget to make it easy
        if(inst && typeof inst.open === 'function') inst.open();
        else if(inst && typeof inst.render === 'function') inst.render();
      } catch (e) {
        // last resort: prompt with the message to copy manually
        prompt("Copy this message and paste it into the chat:", text);
      }
    }
  </script>

  <!--
    Dialog / response suggestions for your Watson Assistant (configure these in the Watson UI):

    INTENT: workout_plan
      - Examples:
        "Create a 4-week workout plan for muscle gain",
        "I need a workout plan for 3 days a week",
        "Make me a beginner gym plan"
      - Responses (text variations):
        1) "Sure ‚Äî is your goal muscle gain, fat loss, or endurance?"
        2) "Got it. What equipment do you have? (Gym / Home / Dumbbells only)"
        3) "Here‚Äôs a 4-week split: Day1 Push, Day2 Pull, Day3 Legs. Want details for each day?"

    INTENT: exercises
      - Examples:
        "List chest exercises",
        "What are good abs exercises?",
        "Give me a 10-exercise routine"
      - Responses:
        1) "Here are 10 chest exercises with brief instructions: 1) Barbell bench press ‚Äî lie back, press the bar..."
        2) "Do you want bodyweight or gym equipment exercises?"

    INTENT: track_progress
      - Examples:
        "Log my workout",
        "Track progress: bench 70kg x4x8",
        "I finished today's workout"
      - Responses:
        1) "Logged: Chest & Triceps ‚Äî Bench press 4x8 @70kg. Would you like weekly summary?"
        2) "Would you like to add bodyweight, reps, and notes to this entry?"

    Configure these intents, sample utterances and responses inside your Watson Assistant skill.
  -->

</body>
</html>
